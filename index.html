<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Proj4leaflet by kartena</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Proj4leaflet</h1>
        <p>Smooth Proj4js integration with Leaflet.</p>

        <p class="view"><a href="https://github.com/kartena/Proj4Leaflet">View the Project on GitHub <small>kartena/Proj4Leaflet</small></a></p>


        <ul>
          <li><a href="https://github.com/kartena/Proj4Leaflet/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/kartena/Proj4Leaflet/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/kartena/Proj4Leaflet">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>Proj4Leaflet</h1>

<p>This is an early attempt at integrating <a href="http://proj4js.org/">Proj4js</a> with the excellent map client <a href="http://leaflet.cloudmade.com">Leaflet</a>. We decided to put this into a separate library for now to avoid adding unnecessary dependencies to Leaflet.</p>

<p>For more details, see this <a href="http://blog.kartena.se/local-projections-in-a-world-of-spherical-mercator/">blog post on tiling and projections</a>.</p>

<h2>Example</h2>

<p>Defines the EPSG:2400 (RT90) projection in Proj4 format and returns a Leaflet CRS object which can be used as the "crs" option to L.Map.</p>

<div class="highlight"><pre><span class="c1">// RT90</span>
<span class="nx">L</span><span class="p">.</span><span class="nx">CRS</span><span class="p">.</span><span class="nx">proj4js</span><span class="p">(</span><span class="s1">'EPSG:2400'</span><span class="p">,</span>
  <span class="s1">'+lon_0=15.808277777799999 +lat_0=0.0 +k=1.0 +x_0=1500000.0 '</span> <span class="o">+</span>
  <span class="s1">'+y_0=0.0 +proj=tmerc +ellps=bessel +units=m '</span> <span class="o">+</span>
  <span class="s1">'+towgs84=414.1,41.3,603.1,-0.855,2.141,-7.023,0 +no_defs'</span><span class="p">,</span> 
  <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Transformation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>

<span class="c1">// ETRS89 / UTM zone 33N</span>
<span class="nx">L</span><span class="p">.</span><span class="nx">CRS</span><span class="p">.</span><span class="nx">proj4js</span><span class="p">(</span><span class="s1">'EPSG:25833'</span><span class="p">,</span> 
  <span class="s1">'+proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs'</span><span class="p">,</span> 
  <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Transformation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2500000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9045984</span><span class="p">));</span>

<span class="c1">// SWEREF 99 TM</span>
<span class="nx">L</span><span class="p">.</span><span class="nx">CRS</span><span class="p">.</span><span class="nx">proj4js</span><span class="p">(</span><span class="s1">'EPSG:3006'</span><span class="p">,</span> 
  <span class="s1">'+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs'</span><span class="p">,</span>
  <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Transformation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">218128.7031</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6126002.9379</span><span class="p">));</span>
</pre></div>

<p>More details in <a href="https://github.com/kartena/Proj4Leaflet/blob/master/examples/script.js">examples/script.js</a></p>

<h2>Transformations</h2>

<p>Transformation turns projected coordinates into pixel coordinates corresponding to a given zoom. </p>

<p>It uses the following formula: </p>

<div class="highlight"><pre><span class="nx">point</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_a</span> <span class="o">*</span> <span class="nx">point</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_b</span><span class="p">);</span>                            
<span class="nx">point</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_c</span> <span class="o">*</span> <span class="nx">point</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_d</span><span class="p">);</span>     
</pre></div>

<p>which we usually define as  </p>

<pre><code>a = 1 
b = -(x_origin)
c = -1
d = y_origin
</code></pre>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/kartena">kartena</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>